// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql" // ‡∏´‡∏£‡∏∑‡∏≠ "mysql" ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ MySQL
  url      = env("DATABASE_URL")
}

// üìå ‡∏ï‡∏≤‡∏£‡∏≤‡∏á User
model User {
  user_line_id String @id
  name         String
  surname      String
  email        String

  userQueries UserQuery[]
  purchases   Purchase[]
}

// üìå ‡∏ï‡∏≤‡∏£‡∏≤‡∏á Books
model BookList {
  bibid            Int    @id @default(autoincrement())
  title            String
  author           String
  table_of_content String
  subject          String
}

// üìå ‡∏ï‡∏≤‡∏£‡∏≤‡∏á UserQuery
model UserQuery {
  query_id         String   @id
  user_line_id     String
  user_query       String
  response_success String
  time_stamp       DateTime

  user      User       @relation(fields: [user_line_id], references: [user_line_id])
  purchases Purchase[]
}

// üìå ‡∏ï‡∏≤‡∏£‡∏≤‡∏á Purchase
model Purchase {
  purchase_id   String @id
  query_id      String
  user_line_id  String // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö User
  response_pick String

  userQuery UserQuery @relation(fields: [query_id], references: [query_id])
  user      User      @relation(fields: [user_line_id], references: [user_line_id])
}
